<<<<<<< HEAD
#### if subject has 4 or more weighted SLDs in this visit, classify as PWS
# subdata$group_for_taxo <- ifelse(subdata$Weighted_SLD < 4, 1, 2)
#### use assignments of subjects as CWS for grouping variable
subdata$group_for_taxo <- ifelse(subdata["Group"] == "CWS-rec" | subdata["Group"]=="CWS-per",2,1)
###### paths and params
PATH_BASE <- "C:\\docs\\code\\taxo"
PATH_SOURCE <- paste0(PATH_BASE, "\\sourcedata\\IISRP")
PATH_DER <- paste0(PATH_BASE, "\\derivatives\\IISRP")
PATH_VISITs_TOP <- paste0(PATH_DER, "\\sourcedata_by_visit")
visitnum <- "1"
visitdir <- paste0(PATH_VISITs_TOP, "\\visit-", visitnum)
flucalc_file <- paste0(visitdir, "\\flucalc.csv")
setwd(visitdir)
# Load the packages
# install.packages("readxl") # might need to comment this in if package is not installed
# install.packages("RTaxometrics")
library(readxl)
library(RTaxometrics)
subdata<- read.csv(flucalc_file, check.names=FALSE)
names(subdata) <- gsub("%", "pct", names(subdata))
names(subdata) <- gsub("#", "num", names(subdata))
subdata <- subdata[subdata["Corpus"]=="IISRP",] # remove junk rows
# run taxometrics ---------------------------------------------------------
#### if subject has 4 or more weighted SLDs in this visit, classify as PWS
# subdata$group_for_taxo <- ifelse(subdata$Weighted_SLD < 4, 1, 2)
#### use assignments of subjects as CWS for grouping variable
subdata$group_for_taxo <- ifelse(subdata["Group"] == "CWS-rec" | subdata["Group"]=="CWS-per",2,1)
# data_for_taxo <- subdata[c("num_SLD","pct_Block","group_for_taxo")]
# data_for_taxo <- subdata[c("num_SLD","pct_Block","Weighted_SLD","group_for_taxo")]
# data_for_taxo <- subdata[c("num_Block","num_Prolongation","group_for_taxo")]
# data_for_taxo <- subdata[c("pct_Prolongation","pct_Block","Weighted_SLD","group_for_taxo")]
# data_for_taxo <- subdata[c("num_Prolongation","num_Block","Weighted_SLD","group_for_taxo")]
# data_for_taxo <- subdata[c("num_Prolongation","num_Block","group_for_taxo")]
# data_for_taxo <- subdata[c("num_PWR-RU","num_Block","group_for_taxo")]
# data_for_taxo <- subdata[c("num_PWR-RU","num_Block","num_Prolongation","group_for_taxo")]
# data_for_taxo <- subdata[c("num_PWR","num_Block","num_Prolongation","group_for_taxo")]
# data_for_taxo <- subdata[c("num_Block","num_PWR","num_Prolongation","group_for_taxo")] # best so far?
# data_for_taxo <- subdata[c("num_Prolongation","num_Block","num_PWR","group_for_taxo")]
# data_for_taxo <- subdata[c("num_Prolongation","num_Block","num_PWR","num_PWR-RU","group_for_taxo")] # takes a while
# data_for_taxo <- subdata[c("num_WWR","num_PWR","group_for_taxo")]
# data_for_taxo <- subdata[c("num_WWR","num_Prolongation","group_for_taxo")]
# data_for_taxo <- subdata[c("num_WWR-RU","num_Prolongation","group_for_taxo")]
# data_for_taxo <- subdata[c("Mean_RU","num_SLD","group_for_taxo")]
# data_for_taxo <- subdata[c("Mean_RU","pct_Block","num_SLD","group_for_taxo")] # L mode looks uni vs bimodal
# data_for_taxo <- subdata[c("num_SLD","Mean_RU","pct_Block","group_for_taxo"),] # L mode looks uni vs bimodal
# data_for_taxo <- subdata[c("num_Block","SLD_Ratio","group_for_taxo")] #  ok validities and corr
# data_for_taxo <- subdata[c("num_Block","SLD_Ratio","pct_Total_(SLD+TD)","group_for_taxo")]
# data_for_taxo <- subdata[c("pct_Block","SLD_Ratio","group_for_taxo")] #  ok validities and corr
# data_for_taxo <- subdata[c("Mean_RU","SLD_Ratio","pct_Block","group_for_taxo")] #  ok corr... maxeig cat shows peak
# data_for_taxo <- subdata[c("pct_Block","group_for_taxo")] #  ok corr
# data_for_taxo <- subdata[c("Mean_RU","SLD_Ratio","group_for_taxo")] #  ok corr
# data_for_taxo <- subdata[c("pct_WWR","pct_Block","group_for_taxo")] #  ok corr
data_for_taxo <- subdata[c("pct_Block","pct_WWR","Mean_RU","group_for_taxo")] #  moderate corr... ok mambac maxeig?
taxout <- RunTaxometrics(data_for_taxo)
taxout
=======
install.packages("RTaxometrics")
library(RTaxometrics)
source("C:/docs/code/taxo/analysis_code/run_taxo_on_iisrp.R", echo=TRUE)
>>>>>>> ff921f533e4dbefcb8e046909ea68e38177ed28e
